angular.module("stockings",[]).controller("form",["$scope"].concat(function(r){var o,e;return o={timeout:5e3,custom:{families:["Noto Sans TC"],urls:["https://fonts.googleapis.com/earlyaccess/notosanstc.css"]},active:function(){return setTimeout(function(){return $("html").addClass("wf-active-later")},1500)}},"undefined"!=typeof WebFont&&null!==WebFont&&WebFont.load(o),smoothScroll.init(),r.price={gray:100,azure:100,black:100},r.error={clear:!1},r.initInfo={name:"",phone:"",addr:"",slot:0,shipfee:60,subtotal:0,count:0,cart:{gray:0,azure:0,black:0},submit:!1},r.error={},r.check=function(o){var e;if(r.submit||o)return r.submit=!0,r.error={clear:!0},e=r.info,e.name||(r.error.name="必填"),e.phone||(r.error.phone="必填"),e.addr||(r.error.addr="必填"),e.count<3&&(r.error.count="購買下限為三雙"),r.error.name||r.error.phone||r.error.addr||r.error.count?r.error.clear=!1:void 0},r.$watch("info.cart",function(){return r.info.count=["gray","azure","black"].reduce(function(o,e){return+r.info.cart[e]+o},0),r.info.subtotal=["gray","azure","black"].reduce(function(o,e){return r.price[e]*+r.info.cart[e]+o},0),r.info.count&&(r.info.subtotal+=r.info.shipfee),r.check()},!0),e=new Firebase("https://stockings-2f825.firebaseio.com/purchase"),r.reset=function(o){return r.info=JSON.parse(JSON.stringify(r.initInfo)),r.error={clear:!0},r.submit=!1,o?smoothScroll.animateScroll(document.querySelector("#a-form")):void 0},r.purchase=function(){var o;return r.check(!0),r.error.clear?(r.info.loading=!0,o=JSON.parse(JSON.stringify(r.info)),e.push(o,function(o){return o&&console.log(o),r.$apply(function(){return r.info.loading=!1,r.info.done=!0,fbq("track","Purchase",{value:r.info.subtotal+"",currency:"TWD"}),smoothScroll.animateScroll(document.querySelector("#a-reset"))})})):void 0},r.reset()}));